<<<<<<< HEAD
=======
import { wrapApiHandler } from "../../../api-utils";
>>>>>>> 4f9d35bd5c5bf095848f6fc99f7e7bfe5212365f
import { RouteModule } from "../route-module";
import { apiResolver } from "../../../api-utils/node/api-resolver";
export class PagesAPIRouteModule extends RouteModule {
    constructor(options){
        super(options);
        if (typeof options.userland.default !== "function") {
            throw new Error(`Page ${options.definition.page} does not export a default function.`);
        }
<<<<<<< HEAD
=======
        this.apiResolverWrapped = wrapApiHandler(options.definition.page, apiResolver);
>>>>>>> 4f9d35bd5c5bf095848f6fc99f7e7bfe5212365f
    }
    /**
   *
   * @param req the incoming server request
   * @param res the outgoing server response
   * @param context the context for the render
   */ async render(req, res, context) {
<<<<<<< HEAD
        await apiResolver(req, res, context.query, this.userland, {
=======
        const { apiResolverWrapped } = this;
        await apiResolverWrapped(req, res, context.query, this.userland, {
>>>>>>> 4f9d35bd5c5bf095848f6fc99f7e7bfe5212365f
            ...context.previewProps,
            revalidate: context.revalidate,
            trustHostHeader: context.trustHostHeader,
            allowedRevalidateHeaderKeys: context.allowedRevalidateHeaderKeys,
<<<<<<< HEAD
            hostname: context.hostname
=======
            hostname: context.hostname,
            multiZoneDraftMode: context.multiZoneDraftMode
>>>>>>> 4f9d35bd5c5bf095848f6fc99f7e7bfe5212365f
        }, context.minimalMode, context.dev, context.page);
    }
}
export default PagesAPIRouteModule;

//# sourceMappingURL=module.js.map